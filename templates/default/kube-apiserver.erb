# File created by Chef! Any local changes will be overwritten next Chef run!

# Secure kube configuration parameters go under here when node['kubernetes']['secure']['enabled']
<% if node['kubernetes']['secure']['enabled'] -%>
KUBE_API_ADDRESS="--bind-address=0.0.0.0 --insecure-bind-address=127.0.0.1 "
KUBE_API_PORT="--secure-port=<%= @kubernetes_secure_api_port %> --insecure-port=<%= @kubernetes_api_port %>"
KUBELET_PORT=""
KUBE_ETCD_SERVERS="--etcd-cafile=<%= @etcd_cert_dir %>/client.ca.crt --etcd-certfile=<%= @etcd_cert_dir %>/client.srv.crt --etcd-keyfile=<%= @etcd_cert_dir %>/client.srv.key --etcd-servers=https://127.0.0.1:2379"
KUBE_SERVICE_ADDRESSES="--service-cluster-ip-range=<%= @kubernetes_network %>"
KUBE_ADMISSION_CONTROL="--admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,ResourceQuota --client-ca-file=<%= @etcd_cert_dir %>/client.ca.crt --tls-cert-file=<%= @etcd_cert_dir %>/client.srv.crt --tls-private-key-file=<%= @etcd_cert_dir %>/client.srv.key --kubelet-certificate-authority=<%= @etcd_cert_dir %>/client.ca.crt --kubelet-client-certificate=<%= @etcd_cert_dir %>/client.srv.crt --kubelet-client-key=<%= @etcd_cert_dir %>/client.srv.key"
<% else -%>
# Insecure kube configuration parameters go under here when node['kubernetes']['secure']['enabled']
KUBE_API_ADDRESS="--insecure-bind-address=0.0.0.0"
KUBE_API_PORT="--insecure-port=<%= @kubernetes_api_port %>"
KUBELET_PORT=""
KUBE_ETCD_SERVERS="--etcd-servers=http://<%= @kubernetes_master %>:<%= @etcd_client_port %>"
KUBE_SERVICE_ADDRESSES="--service-cluster-ip-range=<%= @kubernetes_network %>"
KUBE_ADMISSION_CONTROL="--admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,ResourceQuota"
<% end -%>
KUBE_API_ARGS="<%= @kubernetes_api_args %>"